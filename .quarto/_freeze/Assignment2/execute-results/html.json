{
  "hash": "2064a621d3a6e1de3d288b2f80419cd0",
  "result": {
    "markdown": "---\ntitle: \"Assignment 2\"\nlayout: page\n---\n\n\n# 1.Murrell.R\n\nChange pch change the shape of the data points.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(pressure, pch=16)\ntext(150, 600, \n     \"Pressure (mm Hg)\\nversus\\nTemperature (Celsius)\")\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow=c(3, 2))\nnew_x <- c(0.5, 2, 4, 8, 12, 16)\nnew_y1 <- c(1, 1.3, 1.9, 3.4, 3.9, 4.8)\nnew_y2 <- c(4, .8, .5, .45, .4, .3)\n```\n:::\n\n\n## Including Plots\nChange cex change size of the points, bg, color of the points, fg, color of the axis\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(las=1, mar=c(4, 4, 2, 4), cex=0.8) \nplot.new()\nplot.window(range(new_x), c(0, 6))\nlines(new_x, new_y1)\nlines(new_x, new_y2)\npoints(new_x, new_y1, pch=17, cex=6)  # Increased point size with a different shape\npoints(new_x, new_y2, pch=19, bg=\"green\", cex=3)  # Different background color and size\npar(col=\"purple\", fg=\"gray40\", col.axis=\"darkgreen\")\naxis(1, at=seq(0, 16, 4)) # X-axis, min, max, gap\naxis(2, at=seq(0, 6, 2))\naxis(4, at=seq(0, 6, 2))\nbox(bty=\"o\")  # Changed box type\nmtext(\"Time (s)\", side=1, line=2, cex=1)\nmtext(\"Frequency\", side=2, line=2, las=0, cex=1)\nmtext(\"Velocity\", side=4, line=2, las=0, cex=1)\ntext(6, 4, \"Sample Label\")\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mar=c(5.1, 4.1, 4.1, 2.1), col=\"black\", fg=\"black\", col.axis=\"black\")\n```\n:::\n\n\n## Histogram\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nZ <- rnorm(50)\n# Ensure no Z exceeds [-4, 4]\nZ[Z < -4 | Z > 4] <- NA # Selection/set range\nx_vals <- seq(-4, 4, .1) \ndensity_vals <- dnorm(x_vals)\npar(mar=c(4.5, 4.1, 3.1, 0))\nhist(Z, breaks=seq(-4, 4), ylim=c(0, 0.5), \n     col=\"cyan\", freq=FALSE)\nlines(x_vals, dnorm(x_vals), lwd=2)\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Barplot\n\n\n1. par(mar=c(2, 3.1, 2, 2.1)) Margin of the plot: Bottom, Left, Top, Right\n\n2. col=gray(0.1 + seq(1, 9, 2)/11) Shade of grey from 1/11, 3/11, 5/11, 7/11, 9/11\n\n3. names=rep(““, 4)) –> Change x-axis to be empty –> Use mtext to create customized label\n\n4. text(rep(midpts, each=5), apply(VADeaths, 2, cumsum) - VADeaths/2 midpts, each=5 # Position of each text from the bars\n\ntext(rep(midpts, each=5), apply(VADeaths, 2, cumsum) - VADeaths/2 –> Calculate the culmulative sums of death\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar=c(2, 3.1, 2, 2.1))\nmid_points <- barplot(VADeaths, \n                     col=gray(0.1 + seq(1, 9, 2)/11), \n                     names=rep(\"\", 4))\nmtext(sub(\" \", \"\\n\", colnames(VADeaths)),\n      at=mid_points, side=1, line=0.5, cex=0.5)\ntext(rep(mid_points, each=5), apply(VADeaths, 2, cumsum) - VADeaths/2,\n     VADeaths, \n     col=rep(c(\"white\", \"black\"), times=3:2), \n     cex=0.8)\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mar=c(5.1, 4.1, 4.1, 2.1))\n```\n:::\n\n\n## Boxplot\nBoxwex = Boxwidth at= Change position Subset = Subset of data\n\nboxwex = 0.25, at = 1:3 - 0.2, subset= supp == “VC”, col=“white”, xlab=““, ylab=”tooth length”, ylim=c(0,35))\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar=c(3, 4.1, 2, 0))\nboxplot(len ~ dose, data = ToothGrowth,\n        boxwex = 0.3, at = 1:3 - 0.25,\n        subset = supp == \"VC\", col = \"lightblue\",\n        xlab = \"\",\n        ylab = \"Tooth Length\", ylim = c(0, 35))\nmtext(\"Vitamin C Dose (mg)\", side = 1, line = 2.5, cex = 0.8)\nboxplot(len ~ dose, data = ToothGrowth, add = TRUE,\n        boxwex = 0.3, at = 1:3 + 0.25,\n        subset = supp == \"OJ\", col = \"lightgreen\")\nlegend(1.5, 9, c(\"Ascorbic Acid\", \"Orange Juice\"), \n       fill = c(\"lightblue\", \"lightgreen\"), \n       bty = \"n\")\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mar=c(5.1, 4.1, 4.1, 2.1))\n```\n:::\n\n\n## Perspective\n\n\n1.z <- outer(x, y, f) Compute the value of function of x,y and store the value as z And adjusted all missing value of z -1\n\n2.f <- function(x,y) { r <- sqrt(x2+y2); 10 * sin(r)/r } First derived the distance between x and y by r Then calculate a function of x y by the fraction 10 * sin(r)/r\n\n3. persp(x, y, z, theta = 30, phi = 30, expand = 0.5) Theta = rotated angle of z plane Phi = rotated angle of xy plane Expand = Shrink/ Enlarge the width of the image\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_vals <- seq(-12, 12, length = 30)\ny_vals <- x_vals\nf <- function(x, y) { r <- sqrt(x^2 + y^2); 12 * sin(r) / r }\nz_vals <- outer(x_vals, y_vals, f)\nz_vals[is.na(z_vals)] <- 1\n# Adjusting for z-axis label visibility\npar(mar = c(0, 0.5, 0, 0), lwd = 0.5)\npersp(x_vals, y_vals, z_vals, theta = 35, phi = 25, \n      expand = 0.5)\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## Pie Chart\n\nCan use other type of color pie(pie.sales, col = rainbow(6)) pie(pie.sales, col = heat.colors(6))\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar=c(0, 2, 1, 2), xpd=FALSE, cex=0.6)\npie_sales <- c(0.15, 0.25, 0.2, 0.18, 0.05, 0.17)\nnames(pie_sales) <- c(\"Strawberry\", \"Lemon\", \"Apple\", \"Chocolate\", \"Other\", \"Vanilla\")\npie(pie_sales, col = gray(seq(0.2, 1.0, length=6)))\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n# 2.Using Happy Index\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nhpi_data <- read_excel(\"HPI_2024_public_dataset.xlsx\", sheet = \"All Data\", skip = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in A2436 / R2436C1: got 'Coefficients used'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in A2444 / R2444C1: got 'Year by year data'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in G2444 / R2444C7: got 'Means'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in L2444 / R2444C12: got 'Stdevs'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in Q2444 / R2444C17: got 'CoVs'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in D2445 / R2445C4: got 'Scale up factor for year'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in E2445 / R2445C5: got 'Global Pop'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in G2445 / R2445C7: got 'LifeExp'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in H2445 / R2445C8: got 'Ladder'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in I2445 / R2445C9: got 'Carbon'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in J2445 / R2445C10: got 'Adj Lad x Life Exp'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in L2445 / R2445C12: got 'LifeExp'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in M2445 / R2445C13: got 'Ladder'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in N2445 / R2445C14: got 'Carbon'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in Q2445 / R2445C17: got 'LifeExp'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in R2445 / R2445C18: got 'Ladder'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in U2445 / R2445C21: got 'Carbon'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in V2445 / R2445C22: got 'Adj Lad x Life Exp'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2446 / R2446C24: got 'A'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2446 / R2446C25: got 'Year_lookup!A1:A2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2447 / R2447C24: got 'B'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2447 / R2447C25: got 'Year_lookup!B1:B2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2448 / R2448C24: got 'C'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2448 / R2448C25: got 'Year_lookup!C1:C2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2449 / R2449C24: got 'D'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2449 / R2449C25: got 'Year_lookup!D1:D2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2450 / R2450C24: got 'E'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2450 / R2450C25: got 'Year_lookup!E1:E2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2451 / R2451C25: got 'Year_lookup!F1:F2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2452 / R2452C24: got 'G'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2452 / R2452C25: got 'Year_lookup!G1:G2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2453 / R2453C24: got 'H'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2453 / R2453C25: got 'Year_lookup!H1:H2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2454 / R2454C24: got 'I'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2454 / R2454C25: got 'Year_lookup!I1:I2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2455 / R2455C24: got 'J'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2455 / R2455C25: got 'Year_lookup!J1:J2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2456 / R2456C24: got 'K'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2456 / R2456C25: got 'Year_lookup!K1:K2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2457 / R2457C24: got 'L'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2457 / R2457C25: got 'Year_lookup!L1:L2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2458 / R2458C24: got 'M'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2458 / R2458C25: got 'Year_lookup!M1:M2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2459 / R2459C24: got 'N'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2459 / R2459C25: got 'Year_lookup!N1:N2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2460 / R2460C24: got 'O'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2460 / R2460C25: got 'Year_lookup!O1:O2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in X2461 / R2461C24: got 'P'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Y2461 / R2461C25: got 'Year_lookup!P1:P2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in A2466 / R2466C1: got 'Average of all years'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in E2468 / R2468C5: got 'Correlation with HPI'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in P2468 / R2468C16: got 'Extra HPLY (above min)'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting numeric in E2469 / R2469C5: got 'Correlation with HPI\n(2015)'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...15`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...25`\n```\n:::\n\n```{.r .cell-code}\ncolnames(hpi_data) <- gsub(\" \", \"_\", colnames(hpi_data))\ncolnames(hpi_data) <- tolower(colnames(hpi_data))\nattach(hpi_data)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from package:tidyr:\n\n    population\n```\n:::\n\n```{.r .cell-code}\nregion <- as.factor(continent)\ncontinent_labels <- c(\"1\" = \"Latin America\", \"2\" = \"North America & Oceania\", \"3\" = \"Western Europe\", \"4\" = \"Middle East & North Africa\", \"5\" = \"Sub-Saharan Africa\", \"6\" = \"South Asia\", \"7\" = \"Eastern Europe & Central Asia\", \"8\" = \"East Asia\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Test the plot(), points(), lines()\nhpi_data_subset <- hpi_data %>% filter(continent == \"2\")\nattach(hpi_data_subset)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from package:tidyr:\n\n    population\n```\n:::\n\n```{.r .cell-code}\ncountries_list <- unique(country)\npar(las = 1, mar = c(6, 6, 4, 14), cex = 0.8, mgp = c(4, 1, 0))  # Adjust the gap between axis\nplot(year[country == countries_list[1]], gdp_per_capita[country == countries_list[1]], type = \"n\", xlab = \"\", ylab = \"GDP per Capita\", xlim = c(2006, 2021), ylim = range(gdp_per_capita), xaxt = \"n\", yaxt = \"n\")  # Remove default axis\ncolors <- rainbow(length(countries_list))\n\nfor (i in seq_along(countries_list)) {\n  country_data <- hpi_data_subset[country == countries_list[i], ]\n  lines(country_data$year, country_data$gdp_per_capita, col = colors[i], lwd = 2)\n  points(country_data$year, country_data$gdp_per_capita, col = colors[i], pch = 2, bg = \"yellow\")\n  axis(1, at = seq(2006, 2021, 3))\n  axis(2, at = seq(40000, 60000, 5000))\n  box(bty = \"u\")\n  mtext(\"Year\", side = 1, line = 2, cex = 0.8)\n}\nlegend(\"right\", legend = countries_list, col = colors, lty = 1, pch = 2, xpd = TRUE, inset = c(-0.55, 0))\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## Histogram\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhpi_data_2021 <- hpi_data %>% filter(year == \"2021\", !is.na(lifeexp))\nattach(hpi_data_2021)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data_subset:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from package:tidyr:\n\n    population\n```\n:::\n\n```{.r .cell-code}\nmean <- mean(lifeexp)\nsd <- sd(lifeexp)\nx <- seq(min(lifeexp), max(lifeexp), .1)\ndn <- dnorm(x, mean = mean, sd = sd) # Because data is not normally distributed, what need to input the mean and sd to get the line\nhist(lifeexp, breaks=seq(50, 90), ylim=c(0, 0.08), \n     col=\"steelblue\", freq=FALSE, main = \"Life Expectancy in 2021\", xlab=\"Life Expectancy\")\nlines(x, dn, lwd=2)\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mar=c(5.1, 4.1, 4.1, 2.1))\n```\n:::\n\n\n## Boxplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontinent_names2 <- c(\"Latin\\nAmerica\", \"N America\\n& Oceania\", \"Western\\nEurope\", \"MiddleEast\\n& N. Africa\", \"Sub-Saharan\\nAfrica\", \"South\\nAsia\", \"Eastern Europe\\n& Central Asia\", \"East\\nAsia\")\n\npar(mar = c(5, 5, 4, 2))\nboxplot(lifeexp ~ continent, data = hpi_data_2021,\n        col = hcl.colors(length(unique(hpi_data_2021$continent)), palette = \"Set3\"), # See hcl.colors for more option\n        xaxt = \"n\",\n        xlab = \"Continent\",\n        ylab = \"Life Expectancy\",\n        main = \"Distribution of Life Expectancy by Continent\")\naxis(1, at = 1:8, labels = continent_names2, cex.axis=0.6) \n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Pie Chart\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattach(hpi_data_2021)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data_2021 (pos = 3):\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data_subset:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from package:tidyr:\n\n    population\n```\n:::\n\n```{.r .cell-code}\ngdp_mean <- mean(gdp_per_capita, na.rm=TRUE)\nhpi_data_2021_above <- hpi_data_2021 %>%  filter(gdp_per_capita > gdp_mean)%>% group_by(continent) %>% summarise(country_count = n())\nhpi_data_2021_above\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  continent country_count\n      <dbl>         <int>\n1         1             4\n2         2             4\n3         3            20\n4         4             7\n5         7            13\n6         8             5\n```\n:::\n\n```{.r .cell-code}\nhpi_data_2021_above$continent <- as.factor(hpi_data_2021_above$continent)\nhpi_data_2021_above$continent_names <- c(\"1\" = \"Latin America\", \"2\" = \"N America & Oceania\", \"3\" = \"Western Europe\", \"4\" = \"Middle East & N. Africa\", \"7\" = \"Eastern Europe & Central Asia\", \"8\" = \"East Asia\")\nhpi_data_2021_above$percentage <- round((hpi_data_2021_above$country_count / sum(hpi_data_2021_above$country_count)) * 100, 1)\nlabels <- paste(hpi_data_2021_above$continent_names, \" (\", hpi_data_2021_above$percentage, \"%)\", sep = \"\")\npar(mar = c(2, 2, 2, 2)) # Adjust margin to increase pie size\npie(hpi_data_2021_above$country_count, labels = labels, col = hcl.colors(n = nrow(hpi_data_2021_above), palette = \"Set3\"), \n    main = \"Distribution of Countries by Continent\\nwith Above-Average GDP per Capita in 2021\")\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## 3D Perspective Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattach(hpi_data_2021)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data_2021 (pos = 3):\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data_2021 (pos = 4):\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data_subset:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from hpi_data:\n\n    ...15, ...22, ...23, ...24, ...25, adj_lad_x_life_exp,\n    change_in_gdp_(2016-2019), change_in_gdp_(2016-2020),\n    co2_threshold_for_year, continent, country, cov_adj_footprint,\n    cov_adjusted_ladder, extra_hply_(above_min), footprint_category,\n    gdp_per_capita, hpi, hpi_rank, hply/ef, iso, ladder, lifeexp,\n    national_carbon_footprint_(tco2e), population, year\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from package:tidyr:\n\n    population\n```\n:::\n\n```{.r .cell-code}\nx <- sort(unique(na.omit(lifeexp))) # Need to sort x and y so that they are in increasing order, and must be unique to generate f (the distance between x and y)\ny <- sort(unique(na.omit(cov_adj_footprint)))\nf <- function(x,y) { r <- sqrt(x^2+y^2); 10 * sin(r)/r }\nz <- outer(x, y, f)\nz[is.na(z)] <- 1\nz <- outer(x, y, function(x, y) sin(sqrt(x^2 + y^2)))\npar(mar=c(0, 0.5, 0, 0), lwd=0.5)\npersp(x, y, z, theta = 50, phi = 30, \n      expand = 0.5)\n```\n\n::: {.cell-output-display}\n![](Assignment2_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::",
    "supporting": [
      "Assignment2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}